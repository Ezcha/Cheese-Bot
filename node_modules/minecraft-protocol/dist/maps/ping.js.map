{"version":3,"sources":["ping.js"],"names":[],"mappings":";;AAAA,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;AACzB,IAAI,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACjC,IAAI,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;;AAEjC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;;AAEtB,SAAS,IAAI,CAAC,OAAO,EAAE,EAAE,EAAE;AACzB,MAAI,IAAI,GAAG,OAAO,CAAC,IAAI,IAAI,WAAW,CAAC;AACvC,MAAI,IAAI,GAAG,OAAO,CAAC,IAAI,IAAI,KAAK,CAAC;AACjC,MAAI,UAAU,GAAG,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC;AACxE,MAAI,MAAM,GAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,UAAU,CAAC,CAAC;AACjD,MAAI,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;;AAE7B,MAAI,MAAM,GAAG,IAAI,MAAM,CAAC,KAAK,EAAC,OAAO,CAAC,YAAY,CAAC,CAAC;AACpD,QAAM,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,GAAG,EAAE;AAC/B,MAAE,CAAC,GAAG,CAAC,CAAC;GACT,CAAC,CAAC;;AAEH,QAAM,CAAC,IAAI,CAAC,aAAa,EAAE,UAAS,MAAM,EAAE;AAC1C,QAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACvC,QAAI,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;AACvB,UAAM,CAAC,IAAI,CAAC,MAAM,EAAE,UAAS,MAAM,EAAE;AACnC,UAAI,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC;AAClC,QAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AACf,YAAM,CAAC,GAAG,EAAE,CAAC;KACd,CAAC,CAAC;AACH,UAAM,CAAC,KAAK,CAAC,MAAM,EAAE,EAAC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAC,CAAC,CAAC;GACtC,CAAC,CAAC;;AAEH,QAAM,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,QAAQ,EAAE;AACpC,QAAG,QAAQ,KAAK,MAAM,CAAC,MAAM,EAC3B,MAAM,CAAC,KAAK,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;GAClC,CAAC,CAAC;;AAEH,QAAM,CAAC,EAAE,CAAC,SAAS,EAAE,YAAW;AAC9B,UAAM,CAAC,KAAK,CAAC,cAAc,EAAE;AAC3B,qBAAe,EAAE,OAAO,CAAC,OAAO;AAChC,gBAAU,EAAE,IAAI;AAChB,gBAAU,EAAE,IAAI;AAChB,eAAS,EAAE,CAAC;KACb,CAAC,CAAC;AACH,UAAM,CAAC,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC;GAC9B,CAAC,CAAC;;AAEH,QAAM,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;CAC5B","file":"ping.js","sourcesContent":["var net = require('net');\nvar Client = require('./client');\nvar states = require(\"./states\");\n\nmodule.exports = ping;\n\nfunction ping(options, cb) {\n  var host = options.host || 'localhost';\n  var port = options.port || 25565;\n  var optVersion = options.version || require(\"./version\").defaultVersion;\n  var mcData=require(\"minecraft-data\")(optVersion);\n  var version = mcData.version;\n\n  var client = new Client(false,version.majorVersion);\n  client.on('error', function(err) {\n    cb(err);\n  });\n\n  client.once('server_info', function(packet) {\n    var data = JSON.parse(packet.response);\n    var start = Date.now();\n    client.once('ping', function(packet) {\n      data.latency = Date.now() - start;\n      cb(null, data);\n      client.end();\n    });\n    client.write('ping', {time: [0, 0]});\n  });\n\n  client.on('state', function(newState) {\n    if(newState === states.STATUS)\n      client.write('ping_start', {});\n  });\n\n  client.on('connect', function() {\n    client.write('set_protocol', {\n      protocolVersion: version.version,\n      serverHost: host,\n      serverPort: port,\n      nextState: 1\n    });\n    client.state = states.STATUS;\n  });\n\n  client.connect(port, host);\n}\n"],"sourceRoot":"/source/"}