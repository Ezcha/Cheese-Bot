{"version":3,"sources":["serializer.js"],"names":[],"mappings":";;;;;;;;;;AAAA,IAAI,SAAS,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC;;IAE/C,UAAU;YAAV,UAAU;;AACH,WADP,UAAU,CACF,KAAK,EAAC,QAAQ,EAAE;0BADxB,UAAU;;AAEZ,+BAFE,UAAU,6CAEN,EAAE,kBAAkB,EAAE,IAAI,EAAE,EAAE;AACpC,QAAI,CAAC,KAAK,GAAC,KAAK,CAAC;AACjB,QAAI,CAAC,QAAQ,GAAC,QAAQ,CAAC;GACxB;;eALG,UAAU;;WAOI,4BAAC,MAAM,EAAE;AACzB,aAAO,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,EAAC,MAAM,CAAC,CAAC;KAC5D;;;WAES,oBAAC,KAAK,EAAE,GAAG,EAAE,EAAE,EAAE;AACzB,UAAI;AACF,YAAI,GAAG,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;AACzC,YAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AACf,eAAO,EAAE,EAAE,CAAC;OACb,CAAC,OAAO,CAAC,EAAE;AACV,eAAO,EAAE,CAAC,CAAC,CAAC,CAAC;OACd;KACF;;;SAnBG,UAAU;GAAS,SAAS;;IAsB5B,MAAM;YAAN,MAAM;;AACC,WADP,MAAM,CACE,KAAK,EAAC,QAAQ,EAAE;0BADxB,MAAM;;AAER,+BAFE,MAAM,6CAEF,EAAE,kBAAkB,EAAE,IAAI,EAAE,EAAE;AACpC,QAAI,CAAC,KAAK,GAAC,KAAK,CAAC;AACjB,QAAI,CAAC,QAAQ,GAAC,QAAQ,CAAC;GACxB;;eALG,MAAM;;WAOO,2BAAC,MAAM,EAAE;AACxB,aAAO,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,EAAC,MAAM,CAAC,CAAC;KAC3D;;;WAES,oBAAC,KAAK,EAAE,GAAG,EAAE,EAAE,EAAE;AACzB,UAAI,MAAM,CAAC;AACX,UAAI;AACF,cAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;OACxC,CAAC,OAAO,CAAC,EAAE;AACV,eAAO,EAAE,CAAC,CAAC,CAAC,CAAC;OACd;AACD,UAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAClB,aAAO,EAAE,EAAE,CAAC;KACb;;;SApBG,MAAM;GAAS,SAAS;;AAuB9B,MAAM,CAAC,OAAO,GAAC;AACb,YAAU,EAAC,UAAU;AACrB,QAAM,EAAC,MAAM;CACd,CAAC","file":"serializer.js","sourcesContent":["var Transform = require(\"readable-stream\").Transform;\n\nclass Serializer extends Transform {\n  constructor(proto,mainType) {\n    super({ writableObjectMode: true });\n    this.proto=proto;\n    this.mainType=mainType;\n  }\n\n  createPacketBuffer(packet) {\n    return this.proto.createPacketBuffer(this.mainType,packet);\n  }\n\n  _transform(chunk, enc, cb) {\n    try {\n      var buf = this.createPacketBuffer(chunk);\n      this.push(buf);\n      return cb();\n    } catch (e) {\n      return cb(e);\n    }\n  }\n}\n\nclass Parser extends Transform {\n  constructor(proto,mainType) {\n    super({ readableObjectMode: true });\n    this.proto=proto;\n    this.mainType=mainType;\n  }\n\n  parsePacketBuffer(buffer) {\n    return this.proto.parsePacketBuffer(this.mainType,buffer);\n  }\n\n  _transform(chunk, enc, cb) {\n    var packet;\n    try {\n      packet = this.parsePacketBuffer(chunk);\n    } catch (e) {\n      return cb(e);\n    }\n    this.push(packet);\n    return cb();\n  }\n}\n\nmodule.exports={\n  Serializer:Serializer,\n  Parser:Parser\n};"],"sourceRoot":"/source/"}